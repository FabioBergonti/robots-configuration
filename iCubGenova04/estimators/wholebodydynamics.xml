<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE devices PUBLIC "-//YARP//DTD robotInterface 1.0//EN" "http://www.icub.org/DTD/robotInterfaceV1.0.dtd">

<devices robot="iCubGenova04" build="1">
    <device name="wholebodydynamics" type="wholebodydynamics">
        <param name="axesNames">(torso_pitch,torso_roll,torso_yaw,neck_pitch, neck_roll,neck_yaw,l_shoulder_pitch,l_shoulder_roll,l_shoulder_yaw,l_elbow,l_wrist_prosup,l_wrist_pitch,l_wrist_yaw,r_shoulder_pitch,r_shoulder_roll,r_shoulder_yaw,r_elbow,r_wrist_prosup,r_wrist_pitch,r_wrist_yaw,l_hip_pitch,l_hip_roll,l_hip_yaw,l_knee,l_ankle_pitch,l_ankle_roll,r_hip_pitch,r_hip_roll,r_hip_yaw,r_knee,r_ankle_pitch,r_ankle_roll)</param>
        <param name="modelFile">model.urdf</param>
        <param name="fixedFrameGravity">(0,0,-9.81)</param>
        <param name="defaultContactFrames">(l_hand,r_hand,root_link,l_sole,r_sole,r_lower_leg,l_lower_leg,l_elbow_1,r_elbow_1)</param>
        <param name="imuFrameName">imu_frame</param>
        <param name="publishOnROS">true</param>
	<param name="forceTorqueEstimateConfidence">2</param>

        <!-- map between iDynTree links (identified by a name)
             and skinDynLib links (identified by their frame name, a BodyPart enum
             and a local (to the body part) index -->
        <group name="IDYNTREE_SKINDYNLIB_LINKS">
            <param name="root_link">(root_link,1,0)</param>
            <param name="chest"> (chest,1,2)</param>
            <param name="l_upper_arm">(l_upper_arm,3,2)</param>
            <param name="l_hand">(l_hand_dh_frame,3,6)</param>
            <param name="r_hand">(r_hand_dh_frame,4,6)</param>
            <param name="l_elbow_1">(l_elbow_1, 3, 4)</param>
            <param name="r_upper_arm">(r_upper_arm,4,2)</param>
            <param name="r_elbow_1">(r_elbow_1, 4, 4)</param>
            <param name="l_lower_leg">(l_lower_leg,5,3)</param>
            <param name="l_ankle_1">(l_ankle_1,5,4)</param>
            <param name="l_foot">(l_foot_dh_frame,5,5)</param>
            <param name="r_foot">(r_foot_dh_frame,6,5)</param>
            <param name="r_lower_leg">(r_lower_leg,6,3)</param>
            <param name="r_ankle_1">(r_ankle_1,6,4)</param>
            <param name="r_ankle_2">(r_foot_dh_frame,6,5)</param>
        </group>

        <group name="GRAVITY_COMPENSATION">
            <param name="enableGravityCompensation">true</param>
            <param name="gravityCompensationBaseLink">root_link</param>
            <param name="gravityCompensationAxesNames">(torso_pitch,torso_roll,torso_yaw,neck_pitch,neck_roll,neck_yaw,l_shoulder_pitch,l_shoulder_roll,l_shoulder_yaw,l_elbow,r_shoulder_pitch,r_shoulder_roll,r_shoulder_yaw,r_elbow,l_hip_pitch,l_hip_roll,l_hip_yaw,l_knee,l_ankle_pitch,l_ankle_roll,r_hip_pitch,r_hip_roll,r_hip_yaw,r_knee,r_ankle_pitch,r_ankle_roll)</param>
        </group>
       
       <group name="FT_SECONDARY_CALIBRATION">
           <param name="l_leg_ft_sensor"> (-4.882962e-04,7.934812e-04,9.918516e-03,-2.746666e-04,1.159703e-03,-1.428266e-02 
           ,1.892148e-03,1.132237e-02,-3.387555e-03,1.068148e-03,7.629627e-04,-5.890072e-03 
           ,3.695791e-02,-3.051851e-04,2.197333e-03,3.857540e-02,3.607288e-02,2.533036e-03 
           ,-3.051851e-04,-1.678518e-03,7.019257e-04,-3.662221e-04,3.051851e-05,1.098666e-03 
           ,-3.662221e-04,1.281777e-03,-1.831111e-04,1.220740e-04,7.019257e-04,-9.155553e-04 
           ,3.051851e-05,3.051851e-04,6.103702e-05,0,3.051851e-05,1.831111e-04)</param> 

           <param name="l_foot_ft_sensor"> (-6.225776e-03,-5.493332e-04,1.580859e-02,9.155553e-04,-2.777184e-03,-1.504563e-02 
           ,1.251259e-03,1.345866e-02,-5.981628e-03,-1.281777e-03,7.934812e-04,-6.561480e-03 
           ,5.001984e-02,-2.044740e-03,1.617481e-03,4.159673e-02,4.135258e-02,-3.662221e-04 
           ,0,-1.525925e-04,6.103702e-05,-3.051851e-05,0,9.155553e-05 
           ,-6.103702e-05,-2.441481e-04,1.831111e-04,1.831111e-04,1.525925e-04,0 
           ,0,4.577776e-04,-1.220740e-04,-3.051851e-05,0,-3.051851e-04)</param> 

           <param name="r_leg_ft_sensor"> (-1.800592e-03,-2.533036e-03,1.815851e-02,-1.770074e-03,-2.166814e-03,-1.318400e-02 
           ,-5.493332e-04,8.148442e-03,-3.967406e-03,7.324442e-04,-1.953185e-03,-3.631703e-03 
           ,3.744621e-02,-3.143406e-03,4.272591e-04,3.854488e-02,3.741569e-02,9.765923e-04 
           ,1.525925e-04,-1.159703e-03,9.460738e-04,-2.746666e-04,4.882962e-04,5.188147e-04 
           ,-6.408887e-04,-8.545183e-04,6.714072e-04,3.662221e-04,9.155553e-05,9.155553e-05 
           ,0,3.357036e-04,2.136296e-04,-3.051851e-05,0,-3.051851e-05)</param> 

           <param name="r_foot_ft_sensor"> (-5.462813e-03,7.629627e-04,1.446577e-02,-6.073183e-03,-6.927702e-03,-1.577807e-02 
           ,2.044740e-03,1.379437e-02,-6.286813e-03,-6.103702e-04,1.800592e-03,-6.775109e-03 
           ,5.383465e-02,-1.251259e-03,1.678518e-03,4.165777e-02,4.272591e-02,9.765923e-04 
           ,-2.136296e-04,-3.051851e-04,2.441481e-04,-1.220740e-04,-9.155553e-05,9.155553e-05 
           ,-3.051851e-04,3.051851e-05,1.525925e-04,0,9.155553e-05,-1.831111e-04 
           ,9.155553e-05,4.577776e-04,-3.051851e-04,0,9.155553e-05,-1.525925e-04)</param> 
       </group>


        <group name="WBD_OUTPUT_EXTERNAL_WRENCH_PORTS">
	    <param name="/wholeBodyDynamics/left_arm/cartesianEndEffectorWrench:o">(l_hand,l_hand_dh_frame,root_link)</param>
            <param name="/wholeBodyDynamics/right_arm/cartesianEndEffectorWrench:o">(r_hand,r_hand_dh_frame,root_link)</param>
            <param name="/wholeBodyDynamics/left_leg/cartesianEndEffectorWrench:o">(l_foot,l_sole,root_link)</param>
            <param name="/wholeBodyDynamics/left_foot/cartesianEndEffectorWrench:o">(l_foot,l_sole,l_sole)</param>
            <param name="/wholeBodyDynamics/right_leg/cartesianEndEffectorWrench:o">(r_ankle_2,r_sole,root_link)</param>
            <param name="/wholeBodyDynamics/right_foot/cartesianEndEffectorWrench:o">(r_ankle_2,r_sole,l_sole)</param>
        </group>

        <action phase="startup" level="15" type="attach">
            <paramlist name="networks">
                <!-- motorcontrol and virtual torque sensors -->
                <elem name="left_lower_leg">left_leg-eb7-j4_5-mc</elem>
                <elem name="right_lower_leg">right_leg-eb9-j4_5-mc</elem>
                <elem name="left_upper_leg">left_leg-eb6-j0_3-mc</elem>
                <elem name="right_upper_leg">right_leg-eb8-j0_3-mc</elem>
                <elem name="torso">torso-eb5-j0_2-mc</elem>
                <elem name="right_lower_arm">right_arm-eb27-j4_7-mc</elem>
                <elem name="left_lower_arm">left_arm-eb24-j4_7-mc</elem>
                <elem name="right_upper_arm">right_arm-eb3-j0_3-mc</elem>
                <elem name="left_upper_arm">left_arm-eb1-j0_3-mc</elem>
                <elem name="head-j0">head-eb20-j0_1-mc</elem>
                <elem name="head-j2">head-eb21-j2_5-mc</elem>
                <!-- imu -->
                <elem name="imu">inertial</elem>
                <!-- ft -->
                <elem name="l_arm_ft_sensor">left_arm-eb1-j0_3-strain</elem>
                <elem name="r_arm_ft_sensor">right_arm-eb3-j0_3-strain</elem>
                <elem name="l_leg_ft_sensor">left_leg-eb6-j0_3-strain</elem>
                <elem name="r_leg_ft_sensor">right_leg-eb8-j0_3-strain</elem>
                <elem name="l_foot_ft_sensor">left_leg-eb7-j4_5-strain</elem>
                <elem name="r_foot_ft_sensor">right_leg-eb9-j4_5-strain</elem>
            </paramlist>
        </action>

        <action phase="shutdown" level="2" type="detach" />

    </device>
</devices>
